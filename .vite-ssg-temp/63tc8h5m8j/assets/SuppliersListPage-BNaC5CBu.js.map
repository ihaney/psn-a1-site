{"version":3,"file":"SuppliersListPage-BNaC5CBu.js","sources":["../../../src/pages/SuppliersListPage.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useQuery } from '@tanstack/react-query';\nimport { ChevronRight, ChevronLeft, Building2, MapPin } from 'lucide-react';\nimport SEO from '../components/SEO';\nimport LoadingSpinner from '../components/LoadingSpinner';\nimport Breadcrumbs from '../components/Breadcrumbs';\nimport { createSupplierUrl } from '../utils/urlHelpers';\nimport { supabase } from '../lib/supabase';\n\ninterface SupplierListItem {\n  Supplier_ID: string;\n  Supplier_Title: string;\n  Supplier_Description: string;\n  Supplier_Website: string;\n  Supplier_Email: string;\n  Supplier_Location: string;\n  Supplier_Whatsapp: string;\n  Supplier_Country_Name: string;\n  Supplier_City_Name: string;\n  Supplier_Source_ID: string;\n}\n\nconst SUPPLIERS_PER_PAGE = 50;\n\nexport default function SuppliersListPage() {\n  const navigate = useNavigate();\n  const [currentPage, setCurrentPage] = useState(0);\n  \n  // Use the same direct query approach that works elsewhere in the app\n  const { data, isLoading, error } = useQuery({\n    queryKey: ['suppliersList', currentPage],\n    queryFn: async () => {\n      const from = currentPage * SUPPLIERS_PER_PAGE;\n      const to = from + SUPPLIERS_PER_PAGE - 1;\n\n      // Get suppliers with count for pagination - using the same pattern as other pages\n      const { data: suppliersData, error: suppliersError, count } = await supabase\n        .from('Supplier')\n        .select('*', { count: 'exact' })\n        .range(from, to)\n        .order('Supplier_Title', { ascending: true });\n\n      if (suppliersError) {\n        console.error('Error fetching suppliers:', suppliersError);\n        throw suppliersError;\n      }\n\n      const suppliers: SupplierListItem[] = (suppliersData || []).map(supplier => ({\n        Supplier_ID: supplier.Supplier_ID,\n        Supplier_Title: supplier.Supplier_Title || 'Unknown Supplier',\n        Supplier_Description: supplier.Supplier_Description || '',\n        Supplier_Website: supplier.Supplier_Website || '',\n        Supplier_Email: supplier.Supplier_Email || '',\n        Supplier_Location: supplier.Supplier_Location || '',\n        Supplier_Whatsapp: supplier.Supplier_Whatsapp || '',\n        Supplier_Country_Name: supplier.Supplier_Country_Name || 'Unknown',\n        Supplier_City_Name: supplier.Supplier_City_Name || '',\n        Supplier_Source_ID: supplier.Supplier_Source_ID || ''\n      }));\n\n      const totalCount = count || 0;\n      const totalPages = Math.ceil(totalCount / SUPPLIERS_PER_PAGE);\n      const hasNextPage = currentPage < totalPages - 1;\n      const hasPrevPage = currentPage > 0;\n\n      return {\n        data: suppliers,\n        totalCount,\n        currentPage,\n        totalPages,\n        hasNextPage,\n        hasPrevPage\n      };\n    },\n    staleTime: 1000 * 60 * 5, // 5 minutes\n  });\n\n  const suppliers = data?.data || [];\n  const totalCount = data?.totalCount || 0;\n  const totalPages = data?.totalPages || 0;\n  const hasNextPage = data?.hasNextPage || false;\n  const hasPrevPage = data?.hasPrevPage || false;\n\n  const handleNextPage = () => {\n    if (hasNextPage) {\n      setCurrentPage(prev => prev + 1);\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    }\n  };\n\n  const handlePrevPage = () => {\n    if (hasPrevPage) {\n      setCurrentPage(prev => prev - 1);\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    }\n  };\n\n  const handleSupplierClick = (supplier: SupplierListItem) => {\n    navigate(createSupplierUrl(supplier.Supplier_Title, supplier.Supplier_ID));\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <LoadingSpinner />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <>\n        <SEO \n          title=\"Error Loading Suppliers\"\n          description=\"Unable to load suppliers directory. Please try again later.\"\n        />\n        <div className=\"pt-24 pb-16 px-4 sm:px-6 lg:px-8\">\n          <div className=\"max-w-7xl mx-auto text-center\">\n            <h1 className=\"text-3xl font-bold text-red-500 mb-4\">Error Loading Suppliers</h1>\n            <p className=\"text-gray-300\">Please try refreshing the page.</p>\n            <p className=\"text-sm text-gray-400 mt-2\">{error.message}</p>\n          </div>\n        </div>\n      </>\n    );\n  }\n\n  return (\n    <>\n      <SEO \n        title=\"Suppliers Directory\"\n        description={`Browse ${totalCount.toLocaleString()} verified Latin American suppliers. Find trusted wholesale suppliers across Latin America.`}\n        keywords=\"Latin American suppliers, wholesale suppliers, B2B suppliers, verified suppliers\"\n      />\n      <div className=\"pt-24 pb-16 px-4 sm:px-6 lg:px-8\">\n        <div className=\"max-w-7xl mx-auto\">\n          <Breadcrumbs currentPageTitle=\"Suppliers Directory\" />\n\n          <div className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4\">\n              <div>\n                <p className=\"text-gray-400\">\n                  Showing {suppliers.length} of {totalCount.toLocaleString()} suppliers\n                  {currentPage > 0 && ` (Page ${currentPage + 1} of ${totalPages})`}\n                </p>\n              </div>\n            </div>\n            \n            {suppliers.length > 0 ? (\n              <>\n                <div className=\"grid grid-cols-1 gap-6\" data-tour=\"suppliers-list\">\n                  {suppliers.map((supplier) => (\n                    <div\n                      key={supplier.Supplier_ID}\n                      onClick={() => handleSupplierClick(supplier)}\n                      className=\"group cursor-pointer bg-gray-800/50 backdrop-blur-sm rounded-lg p-6 hover:bg-gray-700/50 transition-all duration-200\"\n                    >\n                      <div className=\"flex items-start gap-4\">\n                        <div className=\"flex-shrink-0\">\n                          <div className=\"w-12 h-12 bg-[#F4A024]/10 rounded-lg flex items-center justify-center group-hover:bg-[#F4A024]/20 transition-colors\">\n                            <Building2 className=\"w-6 h-6 text-[#F4A024]\" />\n                          </div>\n                        </div>\n                        \n                        <div className=\"flex-1 min-w-0\">\n                          <h3 className=\"text-lg font-semibold text-gray-100 mb-2 group-hover:text-[#F4A024] transition-colors\">\n                            {supplier.Supplier_Title}\n                          </h3>\n                          \n                          {supplier.Supplier_Description && (\n                            <p className=\"text-gray-300 text-sm mb-3 line-clamp-2 leading-relaxed\">\n                              {supplier.Supplier_Description}\n                            </p>\n                          )}\n                          \n                          <div className=\"flex flex-wrap gap-3 text-sm text-gray-400\">\n                            {(supplier.Supplier_Country_Name || supplier.Supplier_Location) && (\n                              <div className=\"flex items-center gap-1\">\n                                <MapPin className=\"w-4 h-4\" />\n                                <span>\n                                  {supplier.Supplier_Location || \n                                   `${supplier.Supplier_City_Name ? supplier.Supplier_City_Name + ', ' : ''}${supplier.Supplier_Country_Name}`}\n                                </span>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                \n                {/* Pagination Controls */}\n                {totalPages > 1 && (\n                  <div className=\"flex justify-center items-center gap-4 mt-8\">\n                    <button\n                      onClick={handlePrevPage}\n                      disabled={!hasPrevPage}\n                      className=\"flex items-center gap-2 px-4 py-2 bg-gray-800/50 rounded-lg text-gray-300 hover:bg-gray-700/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      <ChevronLeft className=\"w-4 h-4\" />\n                      Previous\n                    </button>\n                    \n                    <span className=\"text-gray-400\">\n                      Page {currentPage + 1} of {totalPages}\n                    </span>\n                    \n                    <button\n                      onClick={handleNextPage}\n                      disabled={!hasNextPage}\n                      className=\"flex items-center gap-2 px-4 py-2 bg-gray-800/50 rounded-lg text-gray-300 hover:bg-gray-700/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      Next\n                      <ChevronRight className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                )}\n              </>\n            ) : (\n              <div className=\"text-center py-12 bg-gray-800/30 rounded-lg\">\n                <p className=\"text-gray-400\">No suppliers found.</p>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}"],"names":["suppliers","totalCount","totalPages","hasNextPage","hasPrevPage"],"mappings":"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"}